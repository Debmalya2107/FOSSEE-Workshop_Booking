{% extends 'workshop_app/base.html' %}
{% load static %}

{% block title %}
    Add / Edit Workshop Type
{% endblock %}

{% block extra-dependencies %}
{% endblock %}

{% block extra-custom-scripts %}
    <script src="{% static 'workshop_app/js/jquery.formset.js' %}"></script>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <!-- Page Heading -->
    <h2 class="text-center text-primary mb-4">View / Edit Workshop Type</h2>

    <!-- Form Start -->
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Workshop Name -->
        <div class="form-group row my-3">
            <label class="col-md-3 col-form-label font-weight-bold">Workshop Name :</label>
            <div class="col-md-9">
                {{ form.name }}
                <div class="text-danger small">{{ form.name.errors }}</div>
            </div>
        </div>

        <!-- Duration -->
        <div class="form-group row my-3">
            <label class="col-md-3 col-form-label font-weight-bold">Duration :</label>
            <div class="col-md-9">
                {{ form.duration }}
                <div class="form-text text-muted small">{{ form.duration.help_text }}</div>
                <div class="text-danger small">{{ form.duration.errors }}</div>
            </div>
        </div>

        <!-- Description -->
        <div class="form-group row my-3">
            <label class="col-md-3 col-form-label font-weight-bold">Description :</label>
            <div class="col-md-9">
                {{ form.description }}
                <div class="text-danger small">{{ form.description.errors }}</div>
            </div>
        </div>

        <!-- Terms and Conditions -->
        <div class="form-group row my-3">
            <label class="col-md-3 col-form-label font-weight-bold">Terms and Conditions :</label>
            <div class="col-md-9">
                {{ form.terms_and_conditions }}
                <div class="text-danger small">{{ form.terms_and_conditions.errors }}</div>
            </div>
        </div>

        <!-- Attachments -->
        <h2 class="text-center text-info mt-5 mb-3">Attachments</h2>
        {{ form_file.management_form }}
        {{ form_file.non_form_errors }}

        {% for form in form_file %}
        <div class="inline {{ form_file.prefix }} card p-3 mb-3 shadow-sm border rounded">
            <div class="row">
                <div class="col-md-11">
                    {% for field in form %}
                        <div class="form-group mb-2">
                            {{ field }}
                        </div>
                    {% endfor %}
                </div>
                {% if form.id.value %}
                <div class="col-md-1 d-flex align-items-start justify-content-end">
                    <a href="{% url 'workshop_app:delete_attachment_file' form.id.value %}" 
                       class="btn btn-sm btn-danger">
                        <i class="fa fa-trash"></i> Delete
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}

        <!-- Save Button -->
        <div class="form-group text-right">
            <button type="submit" class="btn btn-lg btn-primary mt-3">
                <i class="fa fa-save"></i> Save
            </button>
        </div>
    </form>
</div>

<!-- JS for formset -->
<script type="text/javascript">
    $(function () {
        $(".inline.{{ form_file.prefix }}").formset({
            prefix: "{{ form_file.prefix }}",
            addCssClass: "btn btn-outline-success mt-3",
            deleteCssClass: "hidden",
            addText: 'âž• Add another attachment',
            deleteText: '',
            formCssClass: 'inline-form'
        });
    });
</script>

<style>
    .inline-form {
        margin-bottom: 1rem;
    }
    .btn-lg {
        transition: transform 0.2s ease-in-out;
    }
    .btn-lg:hover {
        transform: scale(1.05);
    }
</style>
{% endblock %}
